<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='../static/css/images/logo.png') }}">
    <title>Course Information</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='../static/css/edprovider_style.css') }}">
    <script src="{{ url_for('static', filename='../static/js/edprovider.js') }}"></script>
</head>
<body>
    <header>
        <nav>
            <div class="navi_menu">
                <div class="navi_menu">
                    <a class="active" href="{{ url_for('auth.login') }}"><strong>Home</strong></a>
                    <a class="active" href="{{ url_for('edprovider.edprovidervisuals') }}" class="view-courses-btn">EdProvider Visuals</a>
                    <a class="active" href="{{ url_for('edprovider.user_inquiry') }}" class="submit-inquiry-btn">Submit Inquiry</a>
            </div>
                
            </div>
        </nav>
    </header>

    <div class="container">
        <form action="{{ url_for('edprovider.search_courses') }}" method="POST" class="search-container">
            <input type="text" name="search_query" placeholder="Search by Course Name or Key Learnings" value="{{ search_query }}">
            <button type="submit">Search</button>
        </form>
    </div>

    <div class="container">
        <h2>Course Information</h2>
        <table>
            <thead>
                <tr>
                    <th>Course Name</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Cost (AUD)</th>
                    <th>Key Learnings</th>
                    <th>Registration Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for registration in registrations %}
                <tr id="registration-row-{{ registration._id }}">
                    <td>{{ registration.course_name }}</td>
                    <td>{{ registration.first_name }}</td>
                    <td>{{ registration.last_name }}</td>
                    <td>{{ registration.email }}</td>
                    <td>${{ "%.2f"|format(registration.get('cost', 0.00)) }}</td>
                    <td>{{ registration.key_learnings }}</td>
                    <td>{{ registration.registration_date }}</td>
                    <td>
                        <div class="button-container">
                            <button type="button" class="form-button modify-button" data-registration-id="{{ registration._id }}">Modify</button>
                            <button type="button" class="form-button delete-button" data-registration-id="{{ registration._id }}">Delete</button>
                        </div>
                    </td>                   
                </tr>
                
                <!-- Hidden edit form when modifying -->
                <tr id="edit-row-{{ registration._id }}" style="display:none;">
                    <td colspan="7">
                        <form id="edit-registration-form-{{ registration._id }}" class="edit-registration-form" data-registration-id="{{ registration._id }}">
                            <!-- Course Name -->
                            <input type="text" name="course_name" class="form-input" value="{{ registration.course_name }}" required>

                            <!-- First Name -->
                            <input type="text" name="first_name" class="form-input" value="{{ registration.first_name }}" required>

                            <!-- Last Name -->
                            <input type="text" name="last_name" class="form-input" value="{{ registration.last_name }}" required>

                            <!-- Email -->
                            <input type="email" name="email" class="form-input" value="{{ registration.email }}" required>

                            <!-- Cost -->
                            <input type="number" name="cost" class="form-input" value="{{ registration.get('cost', 0.00) }}" required min="0" step="0.01">

                            <!-- Key Learnings -->
                            <textarea name="key_learnings" class="form-input" required>{{ registration.key_learnings }}</textarea>

                            <button type="submit" class="form-button">Save Changes</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination Controls -->
    <div class="pagination">
        <ul style="list-style-type:none; display:flex; justify-content: center; align-items: center;">
            {% if page > 1 %}
            <li style="margin-right:10px;">
                <a href="{{ url_for('edprovider.view_courses', page=page-1) }}" class="pagination-arrow">&laquo;</a>
            </li>
            {% endif %}
            {% for num in range(1, total_pages + 1) %}
            {% if num == page %}
            <li style="margin-right:10px;">
                <span class="current-page">{{ num }}</span>
            </li>
            {% else %}
            <li style="margin-right:10px;">
                <a href="{{ url_for('edprovider.view_courses', page=num) }}" class="pagination-number">{{ num }}</a>
            </li>
            {% endif %}
            {% endfor %}
            {% if page < total_pages %}
            <li style="margin-left:10px;">
                <a href="{{ url_for('edprovider.view_courses', page=page+1) }}" class="pagination-arrow">&raquo;</a>
            </li>
            {% endif %}
        </ul>
    </div>

    <div class="container">
        <a href="{{ url_for('edprovider.edproviderlanding') }}" class="form-button">Back to Add Course</a>
    </div>
</body>
</html>
